var favorites={main:function(){$("[data-action='printFavorites']").click(favorites.print);$(".listPaginationFavorites").find(".page-link").click(favorites.pagination);$(".addFavorites[data-action='favorites']").click(favorites.addFavourites);$(".addFavorites[data-action='favMultiple']").click(favorites.addMultiFavorites);$("[data-action='deleteFavorites']").click(favorites.delete);$(".your-favourites [data-action='selectAll']").click(favorites.selectAllEvent);$(".your-favourites [data-action='unselectAll']").click(favorites.unselectAllEvent);$('div[id^="pagination_"]').data('loaded',false);$("#pagination_1").data('loaded',true);},pagination:function(event){event.preventDefault();page=$(this).attr("data-page");quantity=$(".listPaginationFavorites").attr("data-quantity");pages=$(".listPaginationFavorites").attr("data-pages");data={"page":page,"quantity":quantity,"pages":pages}
favorites.sendPagination(data);},"sendPagination":function(data){var loaded=$('#pagination_'+data.page).data('loaded');if(loaded){$.ajax({async:true,type:"POST",data:data,dataType:"html",url:validateURL.URL()+'/client/account_change_pagination_favorites',beforeSend:function(){favorites.loading(true)},complete:function(){favorites.loading(false)},success:function(result){$(".listPaginationFavorites").html(result);$(".page-link").click(favorites.pagination);$("[data-action='pagination_favorites']").hide();$("#pagination_"+page).show();},timeout:10000});}else{$.ajax({async:true,type:"POST",data:data,dataType:"html",url:validateURL.URL()+'/client/account_change_items_favorites',beforeSend:function(){favorites.loading(true)},complete:function(){favorites.loading(false)},success:function(result){$("#pagination_"+data.page).html(result);$("#pagination_"+data.page).data('loaded',true);$.ajax({async:true,type:"POST",data:data,dataType:"html",url:validateURL.URL()+'/client/account_change_pagination_favorites',beforeSend:function(){favorites.loading(true)},complete:function(){favorites.loading(false)},success:function(result){$(".listPaginationFavorites").html(result);$(".page-link").click(favorites.pagination);$("[data-action='pagination_favorites']").hide();$("#pagination_"+page).show();},timeout:10000});},timeout:10000});}},"reloadItems":function(){$.ajax({async:true,type:"GET",data:{"items":$items},dataType:"html",url:validateURL.URL()+'/client/reloadItems',success:function(result){$("#favouritesTabshow").html(result);favorites.main();favorites.loading(false);},timeout:10000});},"loading":function(show){if(show){$.busyLoadFull("show");}else{$.busyLoadFull("hide");}},"showNotify":function(elem,csi){if(csi===undefined){csi=null;}let partnumber=elem.attr('data-item');let quantity=(elem.parents('.itemActionBlock').find('.itemCounter input.val').length>0)?elem.parents('.itemActionBlock').find('.itemCounter input.val').val():false;favorites.getItemBasicData(partnumber,quantity,csi)},"getItemBasicData":function(partnumber,quantity,csi){let func=(csi==null||csi==''||!csi)?'getItemBasicData':'getMultiItemBasicData';return $.ajax({async:true,type:"GET",data:{"id":partnumber,"quantity":quantity,'csi':csi},dataType:"html",url:validateURL.URL()+'/products/'+func,success:function(res){let dialog=$('.favourites-dialog.shadow[data-content="dialog"]');dialog.find('.dialog-content .listitems').html(res);if(!dialog.hasClass('active')){dialog.fadeIn(300)}setTimeout(function(){dialog.fadeOut(300);},3500)},timeout:10000});},"checkSelectionStatusItems":function(list){if(list===undefined){list=null;}return list?list.find('.favourites-list_item  input[type="checkbox"][checked]').length:false;},"addFavourites":function(){if($("#csi").find("[data-action='open']").length>0&&$("#csi").find("[data-action='open'] [data-value]").attr('data-value').length>0){let alternative=$("#csi").find("[data-action='open'] [data-value]").attr("data-value")
favorites.add($(this),alternative);}else{favorites.add($(this));}},add:function(elem,alternativeID){if(alternativeID===undefined){alternativeID=null;}let dataSend=(!alternativeID||alternativeID==null||alternativeID=='')?{"item":elem.attr("data-item")}:{"item":elem.attr("data-item"),"csi":alternativeID};let urlSend=(!alternativeID||alternativeID==null||alternativeID=='')?'addFavoriteItem':'addFavoriteMultiItem';console.log(dataSend);$.ajax({async:true,type:"GET",data:dataSend,dataType:"json",url:validateURL.URL()+'/client/'+urlSend,beforeSend:function(){favorites.loading(true)},success:function(result){favorites.loading(false);favorites.successAdd(elem,result,alternativeID);},error:function(err){console.log(err)},timeout:10000});},"successAdd":function(elem,result,csi){if(csi===undefined){csi=null;}favorites.uploadHeader(result.text);setTimeout(function(){favorites.showNotify(elem,csi);$('.inFavList').toggleClass('d-none').siblings('.addFavorites').toggleClass('d-none');},150);},"uploadHeader":function(res){$(".headerMain .favourites-notification .iconFavourite-lg .data").text("("+res+")");},"delete":function(event){event.preventDefault();$items=[];$("[id^='pagination_'] [id^='line_']").each(function(index,elem){if(!$(this).parent().hasClass('list')){let input=$(this).find('input[type="checkbox"]');if(input.val()==1){$(this).remove();$items.push($(this).attr("id").replace("line_",""));}}});if($items.length>0){$.ajax({async:true,type:"GET",data:{"items":$items},dataType:"json",url:validateURL.URL()+'/client/deleteFavoriteItem',beforeSend:function(){favorites.loading(true);},success:function(result){$('.headerMain .favourites-notification .data').text("("+result.text+")");favorites.reloadItems();},timeout:10000});}else{var favMsg=$(this).closest('.fav-actions').siblings('.favoritesMessage');favMsg.addClass('d-flex');if(favMsg.hasClass('d-flex')){$(document).mouseup(function(e){favMsg.removeClass('d-flex');});}}},"print":function(){event.preventDefault();var checked=favorites.checkSelectionStatusItems($(this).parents('.your-favourites').find('[data-action="pagination_favorites"]'));if(checked>0){$items=[];$('.your-favourites').busyLoad('show');$(".favourites-list").find("[type='checkbox']").each(function(){if($(this).is("[checked]")){$items.push($(this).attr("id").replace("item_",""));}});window.open(validateURL.URL()+'/client/printfavorites?items='+$items,"_blank");$('.your-favourites').busyLoad('hide');}else{var favMsg=$(this).closest('.fav-actions').siblings('.favoritesMessage');favMsg.addClass('d-flex');if(favMsg.hasClass('d-flex')){$(document).mouseup(function(e){favMsg.removeClass('d-flex');});}}},"selectAll":function(value){$('.your-favourites .favourites-content .favourites-list .favourites-list_item').each(function(idx,val){let input=$(this).find("input[type=checkbox]");if($(this).parents('.list').length==0){if(value==0){input.parent().addClass('checked');input.attr("checked","checked").val(1);}else{input.parent().removeClass('checked');input.removeAttr("checked").val(0);}}});},"selectAllEvent":function(e){e.preventDefault();favorites.selectAll(0);},"unselectAllEvent":function(e){e.preventDefault();favorites.selectAll(1);}}
$(document).ready(function(){favorites.main()});